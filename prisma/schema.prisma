generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Market {
  id                                 String        @id
  authority                          String
  question                           String
  options                            String[]
  probs                              Float[]
  votes                              BigInt[]
  liquidityParameter                 BigInt
  mint                               String
  tvl                                BigInt
  status                             String
  marketUpdatedAt                    BigInt
  winningOption                      Int?
  numBuyEvents                       Int           @default(0)
  numSellEvents                      Int           @default(0)
  lastSellSharesEventTimestamp       DateTime?
  lastBuySharesEventTimestamp        DateTime?
  lastClaimRewardsEventTimestamp     DateTime?
  lastRevealProbsEventTimestamp      DateTime?
  lastClaimMarketFundsEventTimestamp DateTime?
  lastMarketSettledEventTimestamp    DateTime?
  createdAt                          DateTime      @default(now())
  updatedAt                          DateTime      @updatedAt
  image                              String?
  prices                             MarketPrice[]

  @@map("markets")
}

model MarketPrice {
  id        Int      @id @default(autoincrement())
  marketId  String
  timestamp DateTime
  prob      Float
  createdAt DateTime @default(now())
  market    Market   @relation(fields: [marketId], references: [id], onDelete: Cascade)

  @@index([marketId])
  @@index([timestamp])
  @@index([marketId, timestamp])
  @@map("market_prices")
}
